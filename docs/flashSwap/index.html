<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.58">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous"><title data-react-helmet="true">Flash Swap | DODOEX Docs</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Flash Swap | DODOEX Docs"><meta data-react-helmet="true" name="description" content="What is flash swap"><meta data-react-helmet="true" property="og:description" content="What is flash swap"><meta data-react-helmet="true" property="og:url" content="https://DODOEX.github.io/docs/docs/docs/flashSwap"><link data-react-helmet="true" rel="shortcut icon" href="/docs/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://DODOEX.github.io/docs/docs/docs/flashSwap"><link rel="stylesheet" href="/docs/styles.85d4d080.css">
<link rel="preload" href="/docs/styles.4f2227b2.js" as="script">
<link rel="preload" href="/docs/runtime~main.df72055a.js" as="script">
<link rel="preload" href="/docs/main.a2998dd8.js" as="script">
<link rel="preload" href="/docs/1.23334781.js" as="script">
<link rel="preload" href="/docs/2.cc00209f.js" as="script">
<link rel="preload" href="/docs/43.a026df5d.js" as="script">
<link rel="preload" href="/docs/44.9ec09bd4.js" as="script">
<link rel="preload" href="/docs/64f9f2ab.839f02f0.js" as="script">
<link rel="preload" href="/docs/17896441.15b97436.js" as="script">
<link rel="preload" href="/docs/165077f2.fa24a870.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/docs/"><img class="navbar__logo" src="/docs/img/logo.svg" alt="DODO"><strong class="navbar__title">DODOEX Docs</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/docs/">Docs</a><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Swap</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/docs/"><img class="navbar__logo" src="/docs/img/logo.svg" alt="DODO"><strong class="navbar__title">DODOEX Docs</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/docs/">Docs</a></li><li class="menu__list-item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="menu__link">Swap</a></li><li class="menu__list-item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp" role="complementary"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Start</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/">Introduction of DODO</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Protocol</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/features">DODO&#x27;s Features</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/coreConcept">Core Concept</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Contract</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docs/framework">Framework</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docs/contractUseGuide">Use Guide</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/docs/flashSwap">Flash Swap</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docs/deployedInfo">Deployed</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Use Case</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/initialDODOEXOffering">Initital DODOEX Offering</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Advanced Topics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/backtest">Backtest</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/authority">Authority</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docs/decentralization">decentralization</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="container padding-vert--lg docItemWrapper_1cc7"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Flash Swap</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="what-is-flash-swap"></a>What is flash swap<a aria-hidden="true" tabindex="-1" class="hash-link" href="#what-is-flash-swap" title="Direct link to heading">#</a></h2><p>简单来讲，就是允许你赊账！当你在 DODO buy/sell 的时候，你可以先获得要购买的 token，do anything you want with 这笔钱。之后再支付货款。</p><p>Simply put, you are allowed to pay on credit! When you buy or sell on DODO, you can first get the token you want to buy, do anything you want with the token and then pay for it later.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="how-does-flash-swap-work"></a>How does flash swap work<a aria-hidden="true" tabindex="-1" class="hash-link" href="#how-does-flash-swap-work" title="Direct link to heading">#</a></h2><p><img src="https://dodoex.github.io/docs/img/dodo_flash_swap.jpeg"></p><p>The picture above shows the four steps to make flash swap</p><ol><li>Call the buyBaseToken of the DODO smart contract</li><li>DODO will transfer the Base token to the message sender first</li><li>If the parameter Data of buyBaseToken is not null, the DODO smart contract will call the dodoCall method of the message sender</li><li>After the dodoCall is executed, the DODO smart contract will retrieve the quote token required for this transaction from the message sender</li></ol><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>The sellBaseToken can also perform flash swap in the same way.</p></div></div><p>Flash swap requires the message sender to be a contract that follows below interface.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-javascript codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">interface</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">IDODOCallee</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">dodoCall</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token parameter">bool isBuyBaseToken</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token parameter">        uint256 baseAmount</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token parameter">        uint256 quoteAmount</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token parameter">        bytes calldata data</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> external</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="what-can-flash-swap-do"></a>What can flash swap do<a aria-hidden="true" tabindex="-1" class="hash-link" href="#what-can-flash-swap-do" title="Direct link to heading">#</a></h2><p>Flash swap can significantly improve market effectiveness.</p><p>Market parity is maintained by arbitrageurs. Flash swap can completely eliminate the arbitrageur’s capital requirements, greatly reduce the arbitrage threshold, and promote market effectiveness. Here we will demonstrate a completely trustless and risk free arbitrage contract as a use case of swap flash.</p><p><a href="https://github.com/radar-bear/dodo-smart-contract/blob/master/contracts/helper/UniswapArbitrageur.sol">source code</a></p><p><a href="">deployed address</a></p><p><img src="https://dodoex.github.io/docs/img/dodo_one_click_arbitrage.jpeg"></p><p>An arbitrage consists of the following 9 steps:</p><ol><li>User calls executeBuyArbitrage on Arbitrageur Contract</li><li>Arbitrageur Contract calls buyBaseToken on DODO and triggers flash swap</li><li>DODO transfers 1 WETH to Arbitrageur Contract</li><li>DODO calls dodoCall on Arbitrageur Contract</li><li>Arbitrageur Contract transfers 1 WETH received from DODO to UniswapV2</li><li>Arbitrageur Contract call swap on UniswapV2</li><li>UniswapV2 transfers 200 USDC to Arbitrageur Contract</li><li>DODO call transferFrom and retrieve 150 USDC from Arbitrageur Contract</li><li>Arbitrageur Contract transfers the remaining 50 USDC to User</li></ol><p>In summary</p><ul><li>Flash swap is made up of step 2, 3, 4, and 8</li><li>Uniswap is made up of step 5, 6, and 7</li><li>An user would only notice the process of sending transaction and making profits!</li></ul><p>The shining point of this contract is that users do not need any capital, nor do they need to know dodo and uniswap. Just simply call a function and if the execution succeeds, it will make a profit. In contrast, if the execution fails, only gas will be lost.</p><p>In order to avoid unnecessary gas consumption, we recommend that users use eth_call to execute executeBuyArbitrage or executeSellArbitrage in advance to estimate arbitrage returns. If there is an arbitrage opportunity, these two functions will return profit of quote token and base token after successful execution.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="some-thoughts-on-flash-swap"></a>Some thoughts on flash swap<a aria-hidden="true" tabindex="-1" class="hash-link" href="#some-thoughts-on-flash-swap" title="Direct link to heading">#</a></h2><p>Once you have a deep understanding of flash swap, you will find the superiority of the Defi world over the centralized world. The combinability of smart contracts has increased the fund utilization of Defi to an unprecedented level. Due to the feature of trustlessness, the cost of credit in Defi is incredibly low. Once this financial system can be integrated into the real world, the improvement of productivity for human kind is unbelievable.</p><p>I have discussed the fascinating features of smart contracts with many people, but few people can really feel it. I hope flash swap can become an interesting case that ordinary people can understand and accept.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Flash swap is inspired by <a href="https://dydx.exchange/" target="_blank" rel="noopener noreferrer">DyDx</a> and <a href="https://uniswap.org/docs/v2/core-concepts/flash-swaps" target="_blank" rel="noopener noreferrer">Uniswap</a>. We really appriciate what they have done before!</p></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/docs/flashSwap.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/docs/contractUseGuide"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Use Guide</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/docs/deployedInfo"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Deployed Infomation »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-is-flash-swap" class="table-of-contents__link">What is flash swap</a></li><li><a href="#how-does-flash-swap-work" class="table-of-contents__link">How does flash swap work</a></li><li><a href="#what-can-flash-swap-do" class="table-of-contents__link">What can flash swap do</a></li><li><a href="#some-thoughts-on-flash-swap" class="table-of-contents__link">Some thoughts on flash swap</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Developer</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Deployed Info</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Medium</a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram</a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div></div><div class="text--center"><div>Copyright © 2020 DODOEX, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/docs/styles.4f2227b2.js"></script>
<script src="/docs/runtime~main.df72055a.js"></script>
<script src="/docs/main.a2998dd8.js"></script>
<script src="/docs/1.23334781.js"></script>
<script src="/docs/2.cc00209f.js"></script>
<script src="/docs/43.a026df5d.js"></script>
<script src="/docs/44.9ec09bd4.js"></script>
<script src="/docs/64f9f2ab.839f02f0.js"></script>
<script src="/docs/17896441.15b97436.js"></script>
<script src="/docs/165077f2.fa24a870.js"></script>
</body>
</html>